<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/inspector/assets/SITU.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Situ Design - React Inspector</title>
    
    <!-- Preload Phosphor Icons CDN for faster toolbar loading -->
    <link rel="preload" href="https://unpkg.com/@phosphor-icons/webcomponents@2.1" as="script" crossorigin>
    
    <!-- Load obfuscated utility functions -->
    <script src="/situ-demo-utils.bundle.js" defer></script>
    
    <!-- Load obfuscated inspector -->
    <script src="/inspector/situImport.bundle.js"></script>
    <script>
      // Initialize inspector after bundle loads
      (function() {
        function initInspector() {
          if (typeof window.installReactClickInspector === 'function') {
            console.log('ðŸ” Initializing Situ Design Inspector...');
            window.installReactClickInspector();
            console.log('âœ… Inspector initialized');
            return true;
          } else if (window.SituInspector && typeof window.SituInspector.initialize === 'function') {
            console.log('ðŸ” Initializing Situ Design Inspector (via SituInspector)...');
            window.SituInspector.initialize();
            console.log('âœ… Inspector initialized');
            return true;
          }
          return false;
        }
        
        // Try immediately
        if (document.readyState === 'loading') {
          document.addEventListener('DOMContentLoaded', function() {
            if (!initInspector()) {
              // Retry with delay if bundle isn't loaded yet
              let attempts = 0;
              const maxAttempts = 20;
              const retry = setInterval(function() {
                attempts++;
                if (initInspector() || attempts >= maxAttempts) {
                  clearInterval(retry);
                }
              }, 100);
            }
          });
        } else {
          if (!initInspector()) {
            // Retry with delay if bundle isn't loaded yet
            let attempts = 0;
            const maxAttempts = 20;
            const retry = setInterval(function() {
              attempts++;
              if (initInspector() || attempts >= maxAttempts) {
                clearInterval(retry);
              }
            }, 100);
          }
        }
        
        // Also try on window load as fallback
        window.addEventListener('load', function() {
          if (!window.__SITU_INSPECTOR_INITIALIZED) {
            initInspector();
            window.__SITU_INSPECTOR_INITIALIZED = true;
          }
        });
      })();
    </script>
  
    <script>
      (function(){
        try {
          window.__SITU_ENFORCE_JWT = true;
          window.__SITU_BACKEND_URL = 'https://situ-design-backend-qt3kmin7pq-uc.a.run.app';
        } catch(_) {}
      })();
    </script>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.jsx"></script>
  </body>
</html>
